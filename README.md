# Генерация новостей

Постановка задачи:
"""
На основе имеющихся новостей и их меток влияния нужно обучить ML модель предсказывать влияние новости на цену акций компании.
"""

Задача состоит из следующих этапов:
1) Объединение экселей
2) Получение эмбеддингов
3) Обучение модели и сохранение ее весов
4) проверка результатов



Для 1) этапа:
  - формирования датасета с мусорными новостями делал Аяз отдельно, поэтому полученный ранее generate_news_2.xlsx легче объединить с его экселем вручную

Для 2) этапа - скрипт embeddinger:
transformers_embeddings.ipynb:
  - используем трансформер с хаггинг фейс. Так как он не открывался с рабочего компа, то скачали модель и установили лоукальные пути к ней
  - используем cls токен эмбеддингов каждой новости в качестве эмбеддинга

Для 3) этапа - скрипт parameters_search:
regression_models_training.ipynb:
  - устанавливаем штрафной вес (например, 0.75) у новостей, которые сгенерированы по второму кругу, чтобы модель на них не переобучалось. Используем там, где модели по дефолту принимают sample_weight:
    model.fit(X_train, y_train, sample_weight = sample_weight)
  - сначала пробуем обучить разные модели (либо гридсёрч, либо рендомсёрч - классы в parameters_search)
  - затем когда нашли нужные параметры, обучаем на всей выборке
  - для борьбы с переобучением и для повышения качества используем стейкинг моделей
  - сохраняем веса в .pkl

Для 4) этапа - скрипт predict:
final_pipeline.ipynb:
  - загружаем модели и смотрим на скор